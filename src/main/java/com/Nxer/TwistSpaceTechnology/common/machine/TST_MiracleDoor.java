package com.Nxer.TwistSpaceTechnology.common.machine;

import static com.Nxer.TwistSpaceTechnology.common.GTCMItemList.CriticalPhoton;
import static com.Nxer.TwistSpaceTechnology.common.machine.ValueEnum.amountOfPhotonsEveryMiracleDoorProcessingCost;
import static com.Nxer.TwistSpaceTechnology.common.machine.ValueEnum.multiplierOfMiracleDoorEUCost;
import static com.Nxer.TwistSpaceTechnology.common.machine.ValueEnum.ticksOfMiracleDoorProcessingTime;
import static com.Nxer.TwistSpaceTechnology.util.TextHandler.texter;
import static com.Nxer.TwistSpaceTechnology.util.TextLocalization.Text_SeparatingLine;
import static com.Nxer.TwistSpaceTechnology.util.TextLocalization.Tooltip_Details;
import static com.Nxer.TwistSpaceTechnology.util.TextLocalization.Tooltip_DoNotNeedEnergyHatch;
import static com.Nxer.TwistSpaceTechnology.util.TextLocalization.Tooltip_DoNotNeedMaintenance;
import static com.Nxer.TwistSpaceTechnology.util.TextLocalization.Tooltip_MiracleDoor_00;
import static com.Nxer.TwistSpaceTechnology.util.TextLocalization.Tooltip_MiracleDoor_01;
import static com.Nxer.TwistSpaceTechnology.util.TextLocalization.Tooltip_MiracleDoor_02;
import static com.Nxer.TwistSpaceTechnology.util.TextLocalization.Tooltip_MiracleDoor_03;
import static com.Nxer.TwistSpaceTechnology.util.TextLocalization.Tooltip_MiracleDoor_04;
import static com.Nxer.TwistSpaceTechnology.util.TextLocalization.Tooltip_MiracleDoor_05;
import static com.Nxer.TwistSpaceTechnology.util.TextLocalization.Tooltip_MiracleDoor_06;
import static com.Nxer.TwistSpaceTechnology.util.TextLocalization.Tooltip_MiracleDoor_07;
import static com.Nxer.TwistSpaceTechnology.util.TextLocalization.Tooltip_MiracleDoor_08;
import static com.Nxer.TwistSpaceTechnology.util.TextLocalization.Tooltip_MiracleDoor_2_01;
import static com.Nxer.TwistSpaceTechnology.util.TextLocalization.Tooltip_MiracleDoor_2_02;
import static com.Nxer.TwistSpaceTechnology.util.TextLocalization.Tooltip_MiracleDoor_2_03;
import static com.Nxer.TwistSpaceTechnology.util.TextLocalization.Tooltip_MiracleDoor_2_04;
import static com.Nxer.TwistSpaceTechnology.util.TextLocalization.Tooltip_MiracleDoor_2_05;
import static com.Nxer.TwistSpaceTechnology.util.TextLocalization.Tooltip_MiracleDoor_Controller;
import static com.Nxer.TwistSpaceTechnology.util.TextLocalization.Tooltip_MiracleDoor_MachineType;
import static com.Nxer.TwistSpaceTechnology.util.Utils.metaItemEqual;
import static com.github.technus.tectech.thing.casing.TT_Container_Casings.sBlockCasingsTT;
import static com.gtnewhorizon.structurelib.structure.StructureUtility.ofBlock;
import static com.gtnewhorizon.structurelib.structure.StructureUtility.transpose;
import static gregtech.api.enums.GT_HatchElement.InputBus;
import static gregtech.api.enums.GT_HatchElement.InputHatch;
import static gregtech.api.enums.GT_HatchElement.OutputBus;
import static gregtech.api.enums.GT_HatchElement.OutputHatch;
import static gregtech.api.enums.Textures.BlockIcons.casingTexturePages;

import java.util.List;
import java.util.UUID;

import javax.annotation.Nonnull;

import com.Nxer.TwistSpaceTechnology.common.recipeMap.GTCMRecipe;
import gregtech.api.util.GT_Utility;
import net.minecraft.entity.player.EntityPlayer;
import net.minecraft.entity.player.EntityPlayerMP;
import net.minecraft.item.ItemStack;
import net.minecraft.nbt.NBTTagCompound;
import net.minecraft.tileentity.TileEntity;
import net.minecraft.util.EnumChatFormatting;
import net.minecraft.util.StatCollector;
import net.minecraft.world.World;
import net.minecraftforge.common.util.ForgeDirection;

import com.Nxer.TwistSpaceTechnology.common.machine.multiMachineClasses.GTCM_MultiMachineBase;
import com.Nxer.TwistSpaceTechnology.common.machine.multiMachineClasses.processingLogics.GTCM_ProcessingLogic;
import com.Nxer.TwistSpaceTechnology.util.TextLocalization;
import com.github.technus.tectech.thing.block.QuantumGlassBlock;
import com.gtnewhorizon.structurelib.structure.IItemSource;
import com.gtnewhorizon.structurelib.structure.IStructureDefinition;
import com.gtnewhorizons.gtnhintergalactic.block.IGBlocks;

import galaxyspace.core.register.GSBlocks;
import gregtech.api.GregTech_API;
import gregtech.api.interfaces.IGlobalWirelessEnergy;
import gregtech.api.interfaces.ITexture;
import gregtech.api.interfaces.metatileentity.IMetaTileEntity;
import gregtech.api.interfaces.tileentity.IGregTechTileEntity;
import gregtech.api.logic.ProcessingLogic;
import gregtech.api.recipe.check.CheckRecipeResult;
import gregtech.api.recipe.check.CheckRecipeResultRegistry;
import gregtech.api.render.TextureFactory;
import gregtech.api.util.GTPP_Recipe;
import gregtech.api.util.GT_HatchElementBuilder;
import gregtech.api.util.GT_Multiblock_Tooltip_Builder;
import gregtech.api.util.GT_OverclockCalculator;
import gregtech.api.util.GT_Recipe;
import gregtech.common.items.GT_IntegratedCircuit_Item;
import gtPlusPlus.xmod.gregtech.common.blocks.textures.TexturesGtBlock;
import mcp.mobius.waila.api.IWailaConfigHandler;
import mcp.mobius.waila.api.IWailaDataAccessor;

public class TST_MiracleDoor extends GTCM_MultiMachineBase<TST_MiracleDoor> implements IGlobalWirelessEnergy {

    // region Class Constructor
    public TST_MiracleDoor(int aID, String aName, String aNameRegional) {
        super(aID, aName, aNameRegional);
    }

    public TST_MiracleDoor(String aName) {
        super(aName);
    }

    @Override
    public IMetaTileEntity newMetaEntity(IGregTechTileEntity aTileEntity) {
        return new TST_MiracleDoor(this.mName);
    }

    // endregion

    // region Processing Logic

    private byte mode = 0;
    private UUID ownerUUID;
    private long costingWirelessEUTemp = 0;
    private int needPhotonAmount = 0;

    @Override
    public void getWailaBody(ItemStack itemStack, List<String> currentTip, IWailaDataAccessor accessor,
        IWailaConfigHandler config) {
        super.getWailaBody(itemStack, currentTip, accessor, config);
        final NBTTagCompound tag = accessor.getNBTData();
        currentTip.add(
            EnumChatFormatting.AQUA + texter("Current EU cost: ", "Waila.TST_MiracleDoor.1")
                + EnumChatFormatting.GOLD
                + tag.getLong("costingWirelessEUTemp")
                + EnumChatFormatting.RESET
                + " EU");

    }

    @Override
    public void getWailaNBTData(EntityPlayerMP player, TileEntity tile, NBTTagCompound tag, World world, int x, int y,
        int z) {
        super.getWailaNBTData(player, tile, tag, world, x, y, z);
        final IGregTechTileEntity tileEntity = getBaseMetaTileEntity();
        if (tileEntity != null) {
            tag.setLong("costingWirelessEUTemp", costingWirelessEUTemp);
        }
    }

    @Override
    public void saveNBTData(NBTTagCompound aNBT) {
        super.saveNBTData(aNBT);
        aNBT.setByte("mode",mode);
        aNBT.setLong("costingWirelessEUTemp", costingWirelessEUTemp);
        aNBT.setInteger("needPhotonAmount", needPhotonAmount);
    }

    @Override
    public void loadNBTData(NBTTagCompound aNBT) {
        super.loadNBTData(aNBT);
        mode = aNBT.getByte("mode");
        costingWirelessEUTemp = aNBT.getLong("costingWirelessEUTemp");
        needPhotonAmount = aNBT.getInteger("needPhotonAmount");
    }

    @Override
    public GT_Recipe.GT_Recipe_Map getRecipeMap() {
        if (mode == 1) return GTCMRecipe.instance.StellarForgeRecipes;
        return GTPP_Recipe.GTPP_Recipe_Map.sAlloyBlastSmelterRecipes;
    }

    @Override
    public final void onScrewdriverRightClick(ForgeDirection side, EntityPlayer aPlayer, float aX, float aY, float aZ) {
        if (getBaseMetaTileEntity().isServerSide()) {
            this.mode = (byte) ((this.mode + 1) % 2);
            GT_Utility.sendChatToPlayer(
                aPlayer,
                StatCollector.translateToLocal("MiracleDoor.modeMsg." + this.mode));
        }
    }
    @Nonnull
    @Override
    public CheckRecipeResult checkProcessing() {
        return mode == 1 ? checkProcessing_mode2() : checkProcessing_mode1();
    }

    private boolean checkPhotonsInputting(int amount) {
        int containedAmount = 0;
        for (ItemStack items : getStoredInputsWithoutDualInputHatch()) {
            if (items == null) continue;
            if (metaItemEqual(items, CriticalPhoton.get(1))) {
                containedAmount += items.stackSize;
                if (containedAmount >= amount) return true;
            }
        }
        return false;
    }

    private boolean consumePhoton(int amount) {
        int needAmount = amount;
        for (ItemStack items : getStoredInputsWithoutDualInputHatch()) {
            if (items == null) continue;
            if (metaItemEqual(items, CriticalPhoton.get(1))) {
                if (items.stackSize >= needAmount) {
                    items.stackSize -= needAmount;
                    return true;
                } else {
                    needAmount -= items.stackSize;
                    items.stackSize = 0;
                }
            }
        }
        return false;
    }

    private CheckRecipeResult checkProcessing_mode1() {
        setupProcessingLogic(processingLogic);

        CheckRecipeResult result = doCheckRecipe();
        // inputs are consumed at this point
        updateSlots();
        if (!result.wasSuccessful()) return result;

        mEfficiency = 10000;
        mEfficiencyIncrease = 10000;

        // process wireless EU cost
        costingWirelessEUTemp = processingLogic.getCalculatedEut() * processingLogic.getDuration()
            * multiplierOfMiracleDoorEUCost
            * getOverclockEUCostMultiplier();
        if (!addEUToGlobalEnergyMap(ownerUUID, -costingWirelessEUTemp)) {
            return CheckRecipeResultRegistry.insufficientPower(costingWirelessEUTemp);
        }

        // set progress time a fixed value
        mMaxProgresstime = getProgressTime();

        // normal output
        mOutputItems = processingLogic.getOutputItems();
        mOutputFluids = processingLogic.getOutputFluids();
        needPhotonAmount = amountOfPhotonsEveryMiracleDoorProcessingCost;

        return result;
    }

    private CheckRecipeResult checkProcessing_mode2() {
        setupProcessingLogic(processingLogic);

        CheckRecipeResult result = doCheckRecipe();
        // inputs are consumed at this point
        updateSlots();
        if (!result.wasSuccessful()) return result;

        mEfficiency = 10000;
        mEfficiencyIncrease = 10000;

        // process wireless EU cost
        costingWirelessEUTemp = processingLogic.getCalculatedEut() * processingLogic.getDuration()
                                    * multiplierOfMiracleDoorEUCost
                                    * getOverclockEUCostMultiplier();
        if (!addEUToGlobalEnergyMap(ownerUUID, -costingWirelessEUTemp)) {
            return CheckRecipeResultRegistry.insufficientPower(costingWirelessEUTemp);
        }

        // set progress time a fixed value
        mMaxProgresstime = getProgressTime();

        // normal output
        mOutputItems = processingLogic.getOutputItems();
        mOutputFluids = processingLogic.getOutputFluids();
        needPhotonAmount = amountOfPhotonsEveryMiracleDoorProcessingCost;

        return result;
    }

    private int getOverclockEUCostMultiplier() {
        ItemStack items = getControllerSlot();
        if (items != null && items.getItem() instanceof GT_IntegratedCircuit_Item
            && items.getItemDamage() > 0
            && items.stackSize > 0) {
            return items.getItemDamage() * items.stackSize;
        }
        return 1;
    }

    private int getProgressTime() {
        ItemStack items = getControllerSlot();
        if (items != null && items.getItem() instanceof GT_IntegratedCircuit_Item
            && items.getItemDamage() > 0
            && items.stackSize > 0) {
            return Math.max(1, ticksOfMiracleDoorProcessingTime / items.getItemDamage() / items.stackSize);
        }
        return ticksOfMiracleDoorProcessingTime;
    }

    @Override
    protected ProcessingLogic createProcessingLogic() {
        return new GTCM_ProcessingLogic() {

            @Nonnull
            @Override
            protected GT_OverclockCalculator createOverclockCalculator(@Nonnull GT_Recipe recipe) {
                return GT_OverclockCalculator.ofNoOverclock(recipe);
            }
        }.setMaxParallel(Integer.MAX_VALUE);
    }

    @Override
    protected void setProcessingLogicPower(ProcessingLogic logic) {
        // The voltage is only used for recipe finding
        logic.setAvailableVoltage(Long.MAX_VALUE);
        logic.setAvailableAmperage(1);
        logic.setAmperageOC(false);
    }

    @Override
    public void onFirstTick(IGregTechTileEntity aBaseMetaTileEntity) {
        super.onFirstTick(aBaseMetaTileEntity);
        this.ownerUUID = aBaseMetaTileEntity.getOwnerUuid();
    }

    @Override
    public boolean onRunningTick(ItemStack aStack) {
        if (needPhotonAmount > 0) {
            startRecipeProcessing();
            if (consumePhoton(needPhotonAmount)) {
                needPhotonAmount = 0;
                endRecipeProcessing();
            } else {
                endRecipeProcessing();
                criticalStopMachine();
                return false;
            }
        }
        return super.onRunningTick(aStack);
    }

    @Override
    protected boolean isEnablePerfectOverclock() {
        return false;
    }

    @Override
    protected float getSpeedBonus() {
        return 1;
    }

    @Override
    protected int getMaxParallelRecipes() {
        return Integer.MAX_VALUE;
    }

    @Override
    public boolean checkMachine(IGregTechTileEntity aBaseMetaTileEntity, ItemStack aStack) {
        repairMachine();
        return checkPiece(STRUCTURE_PIECE_MAIN, horizontalOffSet, verticalOffSet, depthOffSet);
    }
    // endregion

    // region Structure
    // spotless:off
    private static final String STRUCTURE_PIECE_MAIN = "mainMiracleDoor";
    private final int horizontalOffSet = 20;
    private final int verticalOffSet = 52;
    private final int depthOffSet = 8;
    @Override
    public void construct(ItemStack stackSize, boolean hintsOnly) {
        repairMachine();
        buildPiece(STRUCTURE_PIECE_MAIN, stackSize, hintsOnly, horizontalOffSet, verticalOffSet, depthOffSet);
    }

    @Override
    public int survivalConstruct(ItemStack stackSize, int elementBudget, IItemSource source, EntityPlayerMP actor) {
        if (this.mMachine) return -1;
        int realBudget = elementBudget >= 200 ? elementBudget : Math.min(200, elementBudget * 5);
        return this.survivialBuildPiece(
            STRUCTURE_PIECE_MAIN,
            stackSize,
            horizontalOffSet,
            verticalOffSet,
            depthOffSet,
            realBudget,
            source,
            actor,
            false,
            true);
    }

    @Override
    public IStructureDefinition<TST_MiracleDoor> getStructureDefinition() {
        return IStructureDefinition
                   .<TST_MiracleDoor>builder()
                   .addShape(STRUCTURE_PIECE_MAIN, transpose(shapeMain))
                   .addElement('A', ofBlock(GregTech_API.sBlockCasings8, 13))
                   .addElement('B', ofBlock(IGBlocks.SpaceElevatorCasing, 1))
                   .addElement('C', ofBlock(IGBlocks.SpaceElevatorCasing, 2))
                   .addElement('D', ofBlock(sBlockCasingsTT, 4))
                   .addElement('E', ofBlock(sBlockCasingsTT, 6))
                   .addElement('F', ofBlock(sBlockCasingsTT, 9))
                   .addElement('G', ofBlock(sBlockCasingsTT, 10))
                   .addElement('H', ofBlock(sBlockCasingsTT, 12))
                   .addElement('I', ofBlock(sBlockCasingsTT, 14))
                   .addElement('J', ofBlock(GSBlocks.DysonSwarmBlocks, 9))
                   .addElement('K', ofBlock(QuantumGlassBlock.INSTANCE, 0))
                   .addElement('L',
                               GT_HatchElementBuilder
                                   .<TST_MiracleDoor>builder()
                                   .atLeast(InputBus, OutputBus, InputHatch, OutputHatch)
                                   .adder(TST_MiracleDoor::addToMachineList)
                                   .dot(1)
                                   .casingIndex(1024+12)
                                   .buildAndChain(sBlockCasingsTT, 12))
                   .build();
    }
/*
Blocks:
A -> ofBlock...(gt.blockcasings8, 13, ...);
B -> ofBlock...(gt.blockcasingsSE, 1, ...);
C -> ofBlock...(gt.blockcasingsSE, 2, ...);
D -> ofBlock...(gt.blockcasingsTT, 4, ...);
E -> ofBlock...(gt.blockcasingsTT, 6, ...);
F -> ofBlock...(gt.blockcasingsTT, 9, ...);
G -> ofBlock...(gt.blockcasingsTT, 10, ...);
H -> ofBlock...(gt.blockcasingsTT, 12, ...);
I -> ofBlock...(gt.blockcasingsTT, 14, ...);
J -> ofBlock...(tile.DysonSwarmPart, 9, ...);
K -> ofBlock...(tile.quantumGlass, 0, ...);
L -> ofBlock...(gt.blockcasingsTT, 12, ...); // io
 */
    private final String[][] shapeMain = new String[][]{
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","               A         A               ","             AA           AA             ","            AAA           AAA            ","           AAA             AAA           ","          AAA               AAA          ","          AA                 AA          ","         A                     A         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","         A                     A         ","          AA                 AA          ","          AAA               AAA          ","           AAA             AAA           ","            AAA           AAA            ","             AA           AA             ","               A         A               ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                A       A                ","              AA         AA              ","            AAA           AAA            ","           AA               AA           ","          AA                 AA          ","         AA                   AA         ","         A                     A         ","        AA                     AA        ","        A                       A        ","       A                         A       ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","       A                         A       ","        A                       A        ","        AA                     AA        ","         A                     A         ","         AA                   AA         ","          AA                 AA          ","           AA               AA           ","            AAA           AAA            ","              AA         AA              ","                A       A                ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","               AA       AA               ","             AAA         AAA             ","           AAA             AAA           ","          AA                 AA          ","         AA                   AA         ","        AA                     AA        ","        A                       A        ","       AA                       AA       ","       A                         A       ","      AA                         AA      ","      A                           A      ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","      A                           A      ","      AA                         AA      ","       A                         A       ","       AA                       AA       ","        A                       A        ","        AA                     AA        ","         AA                   AA         ","          AA                 AA          ","           AAA             AAA           ","             AAA         AAA             ","               AA       AA               ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","              AAAA     AAAA              ","            AAA           AAA            ","           AA               AA           ","          H                   H          ","         H                     H         ","        H                       H        ","       A                         A       ","      AA                         AA      ","      A                           A      ","     AA                           AA     ","     A                             A     ","     A                             A     ","     A                             A     ","                                         ","                                         ","                                         ","                                         ","                                         ","     A                             A     ","     A                             A     ","     A                             A     ","     AA                           AA     ","      A                           A      ","      AA                         AA      ","       A                         A       ","        H                       H        ","         H                     H         ","          H                   H          ","           AA               AA           ","            AAA           AAA            ","              AAAA     AAAA              ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","              AAAA     AAAA              ","            AA             AA            ","          HH                 HH          ","         HH                   HH         ","        HH                     HH        ","       HH                       HH       ","      HH                         HH      ","      H                           H      ","     A                             A     ","     A                             A     ","    A                               A    ","    A                               A    ","    A                               A    ","    A                               A    ","                                         ","                                         ","                                         ","                                         ","                                         ","    A                               A    ","    A                               A    ","    A                               A    ","    A                               A    ","     A                             A     ","     A                             A     ","      H                           H      ","      HH                         HH      ","       HH                       HH       ","        HH                     HH        ","         HH                   HH         ","          HH                 HH          ","            AA             AA            ","              AAAA     AAAA              ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","              AAAA     AAAA              ","            AA             AA            ","          HH                 HH          ","         H                     H         ","        H                       H        ","       H                         H       ","      H                           H      ","     H                             H     ","     H                             H     ","    A                               A    ","    A                               A    ","   A                                 A   ","   A                                 A   ","   A                                 A   ","   A                                 A   ","                                         ","                                         ","                                         ","                                         ","                                         ","   A                                 A   ","   A                                 A   ","   A                                 A   ","   A                                 A   ","    A                               A    ","    A                               A    ","     H                             H     ","     H                             H     ","      H                           H      ","       H                         H       ","        H                       H        ","         H                     H         ","          HH                 HH          ","            AA             AA            ","              AAAA     AAAA              ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","               AA       AA               ","            AAA           AAA            ","          HH                 HH          ","         H                     H         ","        H                       H        ","       IK                       KI       ","      HK                         KH      ","     H                             H     ","    H                               H    ","    H                               H    ","   A                                 A   ","   A                                 A   ","   A                                 A   ","  A                                   A  ","  A                                   A  ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","  A                                   A  ","  A                                   A  ","   A                                 A   ","   A                                 A   ","   A                                 A   ","    H                               H    ","    H                               H    ","     H                             H     ","      HK                         KH      ","       IK                       KI       ","        H                       H        ","         H                     H         ","          HH                 HH          ","            AAA           AAA            ","               AA       AA               ","                                         ","                                         "},
        {"                                         ","                A       A                ","             AAA         AAA             ","           AA               AA           ","         HH                   HH         ","        H                       H        ","       IK                       KI       ","      IFK                       KFI      ","     HKKK                       KKKH     ","    H                               H    ","    H                               H    ","   A                                 A   ","   A                                 A   ","  A                                   A  ","  A                                   A  ","  A                                   A  "," A                                     A ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "," A                                     A ","  A                                   A  ","  A                                   A  ","  A                                   A  ","   A                                 A   ","   A                                 A   ","    H                               H    ","    H                               H    ","     HKKK                       KKKH     ","      IFK                       KFI      ","       IK                       KI       ","        H                       H        ","         HH                   HH         ","           AA               AA           ","             AAA         AAA             ","                A       A                ","                                         "},
        {"                                         ","              AA         AA              ","           AAA             AAA           ","          H                   H          ","        HH                     HH        ","       H                         H       ","      HK                         KH      ","     HKKK                       KKKH     ","    H  KFK                     KFK  H    ","    H   KK                     KK   H    ","   H                                 H   ","  A                                   A  ","  A                                   A  ","  A                                   A  "," A                                     A "," A                                     A ","                                         ","                   KKK                   ","                  KKKKK                  ","                 KKKKKKK                 ","                 KKKKKKK                 ","                 KKKKKKK                 ","                  KKKKK                  ","                   KKK                   ","                                         "," A                                     A "," A                                     A ","  A                                   A  ","  A                                   A  ","  A                                   A  ","   H                                 H   ","    H   KK                     KK   H    ","    H  KFK                     KFK  H    ","     HKKK                       KKKH     ","      HK                         KH      ","       H                         H       ","        HH                     HH        ","          H                   H          ","           AAA             AAA           ","              AA         AA              ","                                         "},
        {"               A         A               ","            AAA           AAA            ","          AA                 AA          ","         H                     H         ","       HH                       HH       ","      H                           H      ","     H                             H     ","    H                               H    ","    H   KK                     KK   H    ","   H    KFK                   KFK    H   ","  A      KK                   KK      A  ","  A                                   A  "," A                                     A "," A                                     A "," A                                     A ","A                 KKKKK                 A","                KKKKKKKKK                ","                KKK   KKK                ","               KKK     KKK               ","               KK       KK               ","               KK       KK               ","               KK       KK               ","               KKK     KKK               ","                KKK   KKK                ","                KKKKKKKKK                ","A                 KKKKK                 A"," A                                     A "," A                                     A "," A                                     A ","  A                                   A  ","  A      KK                   KK      A  ","   H    KFK                   KFK    H   ","    H   KK                     KK   H    ","    H                               H    ","     H                             H     ","      H                           H      ","       HH                       HH       ","         H                     H         ","          AA                 AA          ","            AAA           AAA            ","               A         A               "},
        {"             AA           AA             ","           AA               AA           ","         AA                   AA         ","        H                       H        ","      HH                         HH      ","     H                             H     ","    H                               H    ","    H                               H    ","   H                                 H   ","  A      KK                   KK      A  ","  A      KFK                 KFK      A  "," A        K                   K        A "," A                                     A ","A                  KKK                  A","A                KKKKKKK                A","               KKK     KKK               ","               K         K               ","              KK         KK              ","              K           K              ","             KK           KK             ","             KK           KK             ","             KK           KK             ","              K           K              ","              KK         KK              ","               K         K               ","               KKK     KKK               ","A                KKKKKKK                A","A                  KKK                  A"," A                                     A "," A        K                   K        A ","  A      KFK                 KFK      A  ","  A      KK                   KK      A  ","   H                                 H   ","    H                               H    ","    H                               H    ","     H                             H     ","      HH                         HH      ","        H                       H        ","         AA                   AA         ","           AA               AA           ","             AA           AA             "},
        {"            AAA           AAA            ","          AA                 AA          ","        AA                     AA        ","       A                         A       ","      H                           H      ","     H                             H     ","    H                               H    ","   A                                 A   ","  A                                   A  ","  A                                   A  "," A        K                   K        A "," A         K                 K         A ","A                 KKKKK                 A","A               KKK   KKK               A","A              KK       KK              A","              K           K              ","             KK           KK             ","             K             K             ","            KK             KK            ","            K               K            ","            K               K            ","            K               K            ","            KK             KK            ","             K             K             ","             KK           KK             ","              K           K              ","A              KK       KK              A","A               KKK   KKK               A","A                 KKKKK                 A"," A         K                 K         A "," A        K                   K        A ","  A                                   A  ","  A                                   A  ","   A                                 A   ","    H                               H    ","     H                             H     ","      H                           H      ","       A                         A       ","        AA                     AA        ","          AA                 AA          ","            AAA           AAA            "},
        {"           AAA             AAA           ","         AA                   AA         ","        A                       A        ","      AA                         AA      ","     A                             A     ","    A                               A    ","   A                                 A   ","   A                                 A   ","  A                                   A  "," A                                     A "," A                                     A ","A                  KKK                  A","A               KKK   KKK               A","A              K         K              A","              K           K              ","             K             K             ","            K               K            ","            K               K            ","            K               K            ","           K                 K           ","           K                 K           ","           K                 K           ","            K               K            ","            K               K            ","            K               K            ","             K             K             ","              K           K              ","A              K         K              A","A               KKK   KKK               A","A                  KKK                  A"," A                                     A "," A                                     A ","  A                                   A  ","   A                                 A   ","   A                                 A   ","    A                               A    ","     A                             A     ","      AA                         AA      ","        A                       A        ","         AA                   AA         ","           AAA             AAA           "},
        {"          AAA               AAA          ","         A                     A         ","       AA                       AA       ","      A                           A      ","     A                             A     ","    A                               A    ","   A                                 A   ","  A                                   A  ","  A                                   A  "," A                                     A ","A                                       A","A                KKKKKKK                A","A              KK       KK              A","              K           K              ","             K             K             ","            K               K            ","            K               K            ","           K                 K           ","           K                 K           ","           K                 K           ","           K                 K           ","           K                 K           ","           K                 K           ","           K                 K           ","            K               K            ","            K               K            ","             K             K             ","              K           K              ","A              KK       KK              A","A                KKKKKKK                A","A                                       A"," A                                     A ","  A                                   A  ","  A                                   A  ","   A                                 A   ","    A                               A    ","     A                             A     ","      A                           A      ","       AA                       AA       ","         A                     A         ","          AAA               AAA          "},
        {"          AA                 AA          ","        AA                     AA        ","       A                         A       ","     AA                           AA     ","    A                               A    ","   A                                 A   ","   A                                 A   ","  A                                   A  "," A                                     A "," A                                     A ","A                 KKKKK                 A","A              KKK     KKK              A","              K           K              ","             K             K             ","            K               K            ","           K                 K           ","           K                 K           ","           K                 K           ","          K                   K          ","          K                   K          ","          K                   K          ","          K                   K          ","          K                   K          ","           K                 K           ","           K                 K           ","           K                 K           ","            K               K            ","             K             K             ","              K           K              ","A              KKK     KKK              A","A                 KKKKK                 A"," A                                     A "," A                                     A ","  A                                   A  ","   A                                 A   ","   A                                 A   ","    A                               A    ","     AA                           AA     ","       A                         A       ","        AA                     AA        ","          AA                 AA          "},
        {"         A                     A         ","        A                       A        ","      AA                         AA      ","     A                             A     ","    A                               A    ","   A                                 A   ","  A                                   A  ","  A                                   A  "," A                                     A ","A                                       A","                KKKKKKKKK                ","               K         K               ","             KK           KK             ","            K               K            ","            K               K            ","           K                 K           ","          K                   K          ","          K                   K          ","          K                   K          ","          K                   K          ","          K                   K          ","          K                   K          ","          K                   K          ","          K                   K          ","          K                   K          ","           K                 K           ","            K               K            ","            K               K            ","             KK           KK             ","               K         K               ","                KKKKKKKKK                ","A                                       A"," A                                     A ","  A                                   A  ","  A                                   A  ","   A                                 A   ","    A                               A    ","     A                             A     ","      AA                         AA      ","        A                       A        ","         A                     A         "},
        {"                                         ","       A                         A       ","      A                           A      ","     A                             A     ","    A                               A    ","   A                                 A   ","  A                                   A  "," A                                     A ","                                         ","                   KKK                   ","                KKK   KKK                ","              KK         KK              ","             K             K             ","            K               K            ","           K                 K           ","           K                 K           ","          K                   K          ","          K                   K          ","          K                   K          ","         K                     K         ","         K                     K         ","         K                     K         ","          K                   K          ","          K                   K          ","          K                   K          ","           K                 K           ","           K                 K           ","            K               K            ","             K             K             ","              KK         KK              ","                KKK   KKK                ","                   KKK                   ","                                         "," A                                     A ","  A                                   A  ","   A                                 A   ","    A                               A    ","     A                             A     ","      A                           A      ","       A                         A       ","                                         "},
        {"                                         ","                                         ","                                         ","     A                             A     ","    A                               A    ","   A                                 A   ","                                         ","                                         ","                                         ","                  KKKKK                  ","               KKK     KKK               ","              K           K              ","            KK             KK            ","            K               K            ","           K                 K           ","          K                   K          ","          K                   K          ","          K                   K          ","         K                     K         ","         K                     K         ","         K                     K         ","         K                     K         ","         K                     K         ","          K                   K          ","          K                   K          ","          K                   K          ","           K                 K           ","            K               K            ","            KK             KK            ","              K           K              ","               KKK     KKK               ","                  KKKKK                  ","                                         ","                                         ","                                         ","   A                                 A   ","    A                               A    ","     A                             A     ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                 KKKKKKK                 ","               KK       KK               ","             KK           KK             ","            K               K            ","           K                 K           ","           K                 K           ","          K                   K          ","          K                   K          ","         K                     K         ","         K                     K         ","         K                     K         ","         K                     K         ","         K                     K         ","         K                     K         ","         K                     K         ","          K                   K          ","          K                   K          ","           K                 K           ","           K                 K           ","            K               K            ","             KK           KK             ","               KK       KK               ","                 KKKKKKK                 ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                 KKKKKKK                 ","               KK       KK               ","             KK           KK             ","            K               K            ","           K                 K           ","           K                 K           ","          K                   K          ","          K                   K          ","         K                     K         ","         K                     K         ","         K                     K         ","         K          G          K         ","         K                     K         ","         K                     K         ","         K                     K         ","          K                   K          ","          K                   K          ","           K                 K           ","           K                 K           ","            K               K            ","             KK           KK             ","               KK       KK               ","                 KKKKKKK                 ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                 KKKKKKK                 ","               KK       KK               ","             KK           KK             ","            K               K            ","           K                 K           ","           K                 K           ","          K                   K          ","          K                   K          ","         K                     K         ","         K                     K         ","         K                     K         ","         K                     K         ","         K                     K         ","         K                     K         ","         K                     K         ","          K                   K          ","          K                   K          ","           K                 K           ","           K                 K           ","            K               K            ","             KK           KK             ","               KK       KK               ","                 KKKKKKK                 ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                  KKKKK                  ","               KKK     KKK               ","              K           K              ","            KK             KK            ","            K               K            ","           K                 K           ","          K                   K          ","          K                   K          ","          K                   K          ","         K                     K         ","         K                     K         ","         K                     K         ","         K                     K         ","         K                     K         ","          K                   K          ","          K                   K          ","          K                   K          ","           K                 K           ","            K               K            ","            KK             KK            ","              K           K              ","               KKK     KKK               ","                  KKKKK                  ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                   KKK                   ","                KKK   KKK                ","              KK         KK              ","             K             K             ","            K               K            ","           K                 K           ","           K                 K           ","          K                   K          ","          K                   K          ","          K                   K          ","         K                     K         ","         K                     K         ","         K                     K         ","          K                   K          ","          K                   K          ","          K                   K          ","           K                 K           ","           K                 K           ","            K               K            ","             K             K             ","              KK         KK              ","                KKK   KKK                ","                   KKK                   ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","     A                             A     ","    A                               A    ","   A                                 A   ","                                         ","                                         ","                                         ","                                         ","                KKKKKKKKK                ","               K         K               ","             KK           KK             ","            K               K            ","            K               K            ","           K                 K           ","          K                   K          ","          K                   K          ","          K                   K          ","          K                   K          ","          K                   K          ","          K                   K          ","          K                   K          ","          K                   K          ","          K                   K          ","           K                 K           ","            K               K            ","            K               K            ","             KK           KK             ","               K         K               ","                KKKKKKKKK                ","                                         ","                                         ","                                         ","                                         ","   A                                 A   ","    A                               A    ","     A                             A     ","                                         ","                                         ","                                         "},
        {"                                         ","       A                         A       ","      A                           A      ","     A                             A     ","    A                               A    ","   A                                 A   ","  A                                   A  "," A                                     A ","                                         ","                                         ","                  KKKKK                  ","               KKK     KKK               ","              K           K              ","             K             K             ","            K               K            ","           K                 K           ","           K                 K           ","           K                 K           ","          K                   K          ","          K                   K          ","          K                   K          ","          K                   K          ","          K                   K          ","           K                 K           ","           K                 K           ","           K                 K           ","            K               K            ","             K             K             ","              K           K              ","               KKK     KKK               ","                  KKKKK                  ","                                         ","                                         "," A                                     A ","  A                                   A  ","   A                                 A   ","    A                               A    ","     A                             A     ","      A                           A      ","       A                         A       ","                                         "},
        {"         A                     A         ","        A                       A        ","      AA                         AA      ","     A                             A     ","    A                               A    ","   A                                 A   ","  A                                   A  ","  A                                   A  "," A                                     A ","A                                       A","                                         ","                 KKKKKKK                 ","               KK       KK               ","              K           K              ","             K             K             ","            K               K            ","            K               K            ","           K                 K           ","           K                 K           ","           K                 K           ","           K                 K           ","           K                 K           ","           K                 K           ","           K                 K           ","            K               K            ","            K               K            ","             K             K             ","              K           K              ","               KK       KK               ","                 KKKKKKK                 ","                                         ","A                                       A"," A                                     A ","  A                                   A  ","  A                                   A  ","   A                                 A   ","    A                               A    ","     A                             A     ","      AA                         AA      ","        A                       A        ","         A                     A         "},
        {"          AA                 AA          ","        AA                     AA        ","       A                         A       ","     AA                           AA     ","    A                               A    ","   A                                 A   ","   A                                 A   ","  A                                   A  "," A                                     A "," A                                     A ","A                                       A","A                  KKK                  A","                KKK   KKK                ","               K         K               ","              K           K              ","             K             K             ","            K               K            ","            K               K            ","            K               K            ","           K                 K           ","           K                 K           ","           K                 K           ","            K               K            ","            K               K            ","            K               K            ","             K             K             ","              K           K              ","               K         K               ","                KKK   KKK                ","A                  KKK                  A","A                                       A"," A                                     A "," A                                     A ","  A                                   A  ","   A                                 A   ","   A                                 A   ","    A                               A    ","     AA                           AA     ","       A                         A       ","        AA                     AA        ","          AA                 AA          "},
        {"          AAA               AAA          ","         A                     A         ","       AA                       AA       ","      A                           A      ","     A                             A     ","    A                               A    ","   A                                 A   ","  A                                   A  ","  A                                   A  "," A                                     A ","A                                       A","A                                       A","A                 KKKKK                 A","                KKK   KKK                ","               KK       KK               ","              K           K              ","             KK           KK             ","             K             K             ","            KK             KK            ","            K               K            ","            K               K            ","            K               K            ","            KK             KK            ","             K             K             ","             KK           KK             ","              K           K              ","               KK       KK               ","                KKK   KKK                ","A                 KKKKK                 A","A                                       A","A                                       A"," A                                     A ","  A                                   A  ","  A                                   A  ","   A                                 A   ","    A                               A    ","     A                             A     ","      A                           A      ","       AA                       AA       ","         A                     A         ","          AAA               AAA          "},
        {"           AAA             AAA           ","         AA                   AA         ","        A                       A        ","      AA                         AA      ","     A                             A     ","    A                               A    ","   A                                 A   ","   A                                 A   ","  A                                   A  "," A                                     A "," A                                     A ","A                                       A","A                                       A","A                  KKK                  A","                 KKKKKKK                 ","               KKK     KKK               ","               K         K               ","              KK         KK              ","              K           K              ","             KK           KK             ","             KK           KK             ","             KK           KK             ","              K           K              ","              KK         KK              ","               K         K               ","               KKK     KKK               ","                 KKKKKKK                 ","A                  KKK                  A","A                                       A","A                                       A"," A                                     A "," A                                     A ","  A                                   A  ","   A                                 A   ","   A                                 A   ","    A                               A    ","     A                             A     ","      AA                         AA      ","        A                       A        ","         AA                   AA         ","           AAA             AAA           "},
        {"            AAA           AAA            ","          AA                 AA          ","        AA                     AA        ","       A                         A       ","      H                           H      ","     H                             H     ","    H                               H    ","   A                                 A   ","  A                                   A  ","  A                                   A  "," A        K                   K        A "," A         K                 K         A ","A                                       A","A                                       A","A                                       A","                  KKKKK                  ","                KKKKKKKKK                ","                KKK   KKK                ","               KKK     KKK               ","               KK       KK               ","               KK       KK               ","               KK       KK               ","               KKK     KKK               ","                KKK   KKK                ","                KKKKKKKKK                ","                  KKKKK                  ","A                                       A","A                                       A","A                                       A"," A         K                 K         A "," A        K                   K        A ","  A                                   A  ","  A                                   A  ","   A                                 A   ","    H                               H    ","     H                             H     ","      H                           H      ","       A                         A       ","        AA                     AA        ","          AA                 AA          ","            AAA           AAA            "},
        {"             AA           AA             ","           AA               AA           ","         AA                   AA         ","        H                       H        ","      HH                         HH      ","     H                             H     ","    H                               H    ","    H                               H    ","   H                                 H   ","  A      KK                   KK      A  ","  A      KFK                 KFK      A  "," A        K                   K        A "," A                                     A ","A                                       A","A                                       A","                                         ","                                         ","                   KKK                   ","                  KKKKK                  ","                 KKKKKKK                 ","                 KKKKKKK                 ","                 KKKKKKK                 ","                  KKKKK                  ","                   KKK                   ","                                         ","                                         ","A                                       A","A                                       A"," A                                     A "," A        K                   K        A ","  A      KFK                 KFK      A  ","  A      KK                   KK      A  ","   H                                 H   ","    H                               H    ","    H                               H    ","     H                             H     ","      HH                         HH      ","        H                       H        ","         AA                   AA         ","           AA               AA           ","             AA           AA             "},
        {"               A         A               ","            AAA           AAA            ","          AA                 AA          ","         H                     H         ","       HH                       HH       ","      H                           H      ","     H                             H     ","    H                               H    ","    H   KK                     KK   H    ","   H    KFK                   KFK    H   ","  A      KK                   KK      A  ","  A                                   A  "," A                                     A "," A                                     A "," A                                     A ","A                                       A","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","A                                       A"," A                                     A "," A                                     A "," A                                     A ","  A                                   A  ","  A      KK                   KK      A  ","   H    KFK                   KFK    H   ","    H   KK                     KK   H    ","    H                               H    ","     H                             H     ","      H                           H      ","       HH                       HH       ","         H                     H         ","          AA                 AA          ","            AAA           AAA            ","               A         A               "},
        {"                                         ","              AA         AA              ","           AAA             AAA           ","          H                   H          ","        HH                     HH        ","       H                         H       ","      HK                         KH      ","     HKKK                       KKKH     ","    H  KFK                     KFK  H    ","    H   KK                     KK   H    ","   H                                 H   ","  A                                   A  ","  A                                   A  ","  A                                   A  "," A                                     A "," A                                     A ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "," A                                     A "," A                                     A ","  A                                   A  ","  A                                   A  ","  A                                   A  ","   H                                 H   ","    H   KK                     KK   H    ","    H  KFK                     KFK  H    ","     HKKK                       KKKH     ","      HK                         KH      ","       H                         H       ","        HH                     HH        ","          H                   H          ","           AAA             AAA           ","              AA         AA              ","                                         "},
        {"                                         ","                A       A                ","             AAA         AAA             ","           AA               AA           ","         HH                   HH         ","        H                       H        ","       IK                       KI       ","      IFK                       KFI      ","     HKKK                       KKKH     ","    H                               H    ","    H                               H    ","   A                                 A   ","   A                                 A   ","  A                                   A  ","  A                                   A  ","  A                                   A  "," A                                     A ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "," A                                     A ","  A                                   A  ","  A                                   A  ","  A                                   A  ","   A                                 A   ","   A                                 A   ","    H                               H    ","    H                               H    ","     HKKK                       KKKH     ","      IFK                       KFI      ","       IK                       KI       ","        H                       H        ","         HH                   HH         ","           AA               AA           ","             AAA         AAA             ","                A       A                ","                                         "},
        {"                                         ","                                         ","               AA       AA               ","            AAA           AAA            ","          HH                 HH          ","         H                     H         ","        H                       H        ","       IK                       KI       ","      HK                         KH      ","     H                             H     ","    H                               H    ","    H                               H    ","   A                                 A   ","   A                                 A   ","   A                                 A   ","  A                                   A  ","  A                                   A  ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","  A                                   A  ","  A                                   A  ","   A                                 A   ","   A                                 A   ","   A                                 A   ","    H                               H    ","    H                               H    ","     H                             H     ","      HK                         KH      ","       IK                       KI       ","        H                       H        ","         H                     H         ","          HH                 HH          ","            AAA           AAA            ","               AA       AA               ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","              AAAA     AAAA              ","            AA             AA            ","          HH                 HH          ","         H                     H         ","        H                       H        ","       H                         H       ","      H                           H      ","     H                             H     ","     H                             H     ","    A                               A    ","    A                               A    ","   A                                 A   ","   A                                 A   ","   A                                 A   ","   A                                 A   ","                                         ","                                         ","                                         ","                                         ","                                         ","   A                                 A   ","   A                                 A   ","   A                                 A   ","   A                                 A   ","    A                               A    ","    A                               A    ","     H                             H     ","     H                             H     ","      H                           H      ","       H                         H       ","        H                       H        ","         H                     H         ","          HH                 HH          ","            AA             AA            ","              AAAA     AAAA              ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","              AAAA     AAAA              ","            AA             AA            ","          HH                 HH          ","         HH                   HH         ","        HH                     HH        ","       HH                       HH       ","      HH                         HH      ","      H                           H      ","     A                             A     ","     A                             A     ","    A                               A    ","    A                               A    ","    A                               A    ","    A                               A    ","                                         ","                                         ","                                         ","                                         ","                                         ","    A                               A    ","    A                               A    ","    A                               A    ","    A                               A    ","     A                             A     ","     A                             A     ","      H                           H      ","      HH                         HH      ","       HH                       HH       ","        HH                     HH        ","         HH                   HH         ","          HH                 HH          ","            AA             AA            ","              AAAA     AAAA              ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","              AAAA     AAAA              ","            AAA           AAA            ","           AA               AA           ","          H                   H          ","         H                     H         ","        H                       H        ","       A                         A       ","      AA                         AA      ","      A                           A      ","     AA                           AA     ","     A                             A     ","     A                             A     ","     A                             A     ","                                         ","                                         ","                                         ","                                         ","                                         ","     A                             A     ","     A                             A     ","     A                             A     ","     AA                           AA     ","      A                           A      ","      AA                         AA      ","       A                         A       ","        H                       H        ","         H                     H         ","          H                   H          ","           AA               AA           ","            AAA           AAA            ","              AAAA     AAAA              ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","               AA       AA               ","             AAA         AAA             ","           AAA             AAA           ","          AA                 AA          ","         AA                   AA         ","        AA                     AA        ","        A                       A        ","       AA                       AA       ","       A                         A       ","      AA                         AA      ","      A                           A      ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","      A                           A      ","      AA                         AA      ","       A                         A       ","       AA                       AA       ","        A                       A        ","        AA                     AA        ","         AA                   AA         ","          AA                 AA          ","           AAA             AAA           ","             AAA         AAA             ","               AA       AA               ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                A       A                ","              AA         AA              ","            AAA           AAA            ","           AA               AA           ","          AA                 AA          ","         AA                   AA         ","         A                     A         ","        AA                     AA        ","        A                       A        ","       A                         A       ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","       A                         A       ","        A                       A        ","        AA                     AA        ","         A                     A         ","         AA                   AA         ","          AA                 AA          ","           AA               AA           ","            AAA           AAA            ","              AA         AA              ","                A       A                ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","               A         A               ","             AA           AA             ","            AAA           AAA            ","           AAA             AAA           ","          AAA               AAA          ","          AA                 AA          ","         A                     A         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","         A                     A         ","          AA                 AA          ","          AAA               AAA          ","           AAA             AAA           ","            AAA           AAA            ","             AA           AA             ","               A         A               ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                   GGG                   ","                  GGGGG                  ","                  GGGGG                  ","                  GGGGG                  ","                   GGG                   ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                  GGGGG                  ","                 GG   GG                 ","                 G     G                 ","                 G     G                 ","                 G     G                 ","                 GG   GG                 ","                  GGGGG                  ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                  GGGGG                  ","                 G     G                 ","                G       G                ","                G       G                ","                G       G                ","                G       G                ","                G       G                ","                 G     G                 ","                  GGGGG                  ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                   GGG                   ","                 GG   GG                 ","                G       G                ","                G       G                ","               G         G               ","               G         G               ","               G         G               ","                G       G                ","                G       G                ","                 GG   GG                 ","                   GGG                   ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                   LLL                   ","                   LLL                   ","                   III                   ","                   KKK                   ","                   KKK                   ","                   KKK                   ","                   KKK                   ","                  GGGGG                  ","                 G     G                 ","                G       G                ","               G         G               ","               G         G               ","               G         G               ","               G         G               ","               G         G               ","                G       G                ","                 G     G                 ","                  GGGGG                  ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                   L~L                   ","                   LFL                   ","                   IGI                   ","                   KGK                   ","                   KGK                   ","                   KGK                   ","                   KGK                   ","                  GGGGG                  ","                 G     G                 ","                G       G                ","               G         G               ","               G         G               ","               G         G               ","               G         G               ","               G         G               ","                G       G                ","                 G     G                 ","                  GGGGG                  ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                   LLL                   ","                   LLL                   ","                   III                   ","                 HHHHHHH                 ","               HHEEEEEEEHH               ","              HEEEEEEEEEEEH              ","             HEEEEEEEEEEEEEH             ","            HEEEEEEEEEEEEEEEH            ","            HEEEEEEEEEEEEEEEH            ","           HEEEEEEEEEEEEEEEEEH           ","           HEEEEEEEEEEEEEEEEEH           ","           HEEEEEEEEEEEEEEEEEH           ","           HEEEEEEEEEEEEEEEEEH           ","           HEEEEEEEEEEEEEEEEEH           ","           HEEEEEEEEEEEEEEEEEH           ","           HEEEEEEEEEEEEEEEEEH           ","            HEEEEEEEEEEEEEEEH            ","            HEEEEEEEEEEEEEEEH            ","             HEEEEEEEEEEEEEH             ","              HEEEEEEEEEEEH              ","               HHEEEEEEEHH               ","                 HHHHHHH                 ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                 HHHHHHH                 ","               HHDDDDDDDHH               ","             HHDDDDDDDDDDDHH             ","            HDDDDDDDDDDDDDDDH            ","           HDDDDDDDDDDDDDDDDDH           ","          HDDDDDDDDDDDDDDDDDDDH          ","          HDDDDDDDDDDDDDDDDDDDH          ","         HDDDDDDDDDDDDDDDDDDDDDH         ","         HDDDDDDDDDDDDDDDDDDDDDH         ","        HDDDDDDDDDDDDDDDDDDDDDDDH        ","        HDDDDDDDDDDDDDDDDDDDDDDDH        ","        HDDDDDDDDDDDDDDDDDDDDDDDH        ","        HDDDDDDDDDDDDDDDDDDDDDDDH        ","        HDDDDDDDDDDDDDDDDDDDDDDDH        ","        HDDDDDDDDDDDDDDDDDDDDDDDH        ","        HDDDDDDDDDDDDDDDDDDDDDDDH        ","         HDDDDDDDDDDDDDDDDDDDDDH         ","         HDDDDDDDDDDDDDDDDDDDDDH         ","          HDDDDDDDDDDDDDDDDDDDH          ","          HDDDDDDDDDDDDDDDDDDDH          ","           HDDDDDDDDDDDDDDDDDH           ","            HDDDDDDDDDDDDDDDH            ","             HHDDDDDDDDDDDHH             ","               HHDDDDDDDHH               ","                 HHHHHHH                 ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                 CCCCCCC                 ","              CCCBBBBBBBCCC              ","             CBBBBBBBBBBBBBC             ","           CCBBBBBBBBBBBBBBBCC           ","          CBBBBBBBBBBBBBBBBBBBC          ","          CBBBBBBBBBBBBBBBBBBBC          ","         CBBBBBBBBBBBBBBBBBBBBBC         ","        CBBBBBBBBBBBBBBBBBBBBBBBC        ","        CBBBBBBBBBBBBBBBBBBBBBBBC        ","        CBBBBBBBBBBBBBBBBBBBBBBBC        ","       CBBBBBBBBBBBBBBBBBBBBBBBBBC       ","       CBBBBBBBBBBBBBBBBBBBBBBBBBC       ","       CBBBBBBBBBBBBBBBBBBBBBBBBBC       ","       CBBBBBBBBBBBBBBBBBBBBBBBBBC       ","       CBBBBBBBBBBBBBBBBBBBBBBBBBC       ","       CBBBBBBBBBBBBBBBBBBBBBBBBBC       ","       CBBBBBBBBBBBBBBBBBBBBBBBBBC       ","        CBBBBBBBBBBBBBBBBBBBBBBBC        ","        CBBBBBBBBBBBBBBBBBBBBBBBC        ","        CBBBBBBBBBBBBBBBBBBBBBBBC        ","         CBBBBBBBBBBBBBBBBBBBBBC         ","          CBBBBBBBBBBBBBBBBBBBC          ","          CBBBBBBBBBBBBBBBBBBBC          ","           CCBBBBBBBBBBBBBBBCC           ","             CBBBBBBBBBBBBBC             ","              CCCBBBBBBBCCC              ","                 CCCCCCC                 ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                                         ","                 JJJJJJJ                 ","              JJJJJJJJJJJJJ              ","            JJJJJJJJJJJJJJJJJ            ","           JJJJJJJJJJJJJJJJJJJ           ","          JJJJJJJJJJJJJJJJJJJJJ          ","         JJJJJJJJJJJJJJJJJJJJJJJ         ","        JJJJJJJJJJJJJJJJJJJJJJJJJ        ","        JJJJJJJJJJJJJJJJJJJJJJJJJ        ","       JJJJJJJJJJJJJJJJJJJJJJJJJJJ       ","       JJJJJJJJJJJJJJJJJJJJJJJJJJJ       ","       JJJJJJJJJJJJJJJJJJJJJJJJJJJ       ","      JJJJJJJJJJJJJJJJJJJJJJJJJJJJJ      ","      JJJJJJJJJJJJJJJJJJJJJJJJJJJJJ      ","      JJJJJJJJJJJJJJJJJJJJJJJJJJJJJ      ","      JJJJJJJJJJJJJJJJJJJJJJJJJJJJJ      ","      JJJJJJJJJJJJJJJJJJJJJJJJJJJJJ      ","      JJJJJJJJJJJJJJJJJJJJJJJJJJJJJ      ","      JJJJJJJJJJJJJJJJJJJJJJJJJJJJJ      ","       JJJJJJJJJJJJJJJJJJJJJJJJJJJ       ","       JJJJJJJJJJJJJJJJJJJJJJJJJJJ       ","       JJJJJJJJJJJJJJJJJJJJJJJJJJJ       ","        JJJJJJJJJJJJJJJJJJJJJJJJJ        ","        JJJJJJJJJJJJJJJJJJJJJJJJJ        ","         JJJJJJJJJJJJJJJJJJJJJJJ         ","          JJJJJJJJJJJJJJJJJJJJJ          ","           JJJJJJJJJJJJJJJJJJJ           ","            JJJJJJJJJJJJJJJJJ            ","              JJJJJJJJJJJJJ              ","                 JJJJJJJ                 ","                                         ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                 JJJJJJJ                 ","              JJJJJJJJJJJJJ              ","            JJJJJJJJJJJJJJJJJ            ","           JJJJJJJJJJJJJJJJJJJ           ","          JJJJJJJJJJJJJJJJJJJJJ          ","         JJJJJJJJJJJJJJJJJJJJJJJ         ","        JJJJJJJJJJJJJJJJJJJJJJJJJ        ","       JJJJJJJJJJJJJJJJJJJJJJJJJJJ       ","       JJJJJJJJJJJJJJJJJJJJJJJJJJJ       ","      JJJJJJJJJJJJJJJJJJJJJJJJJJJJJ      ","      JJJJJJJJJJJJJJJJJJJJJJJJJJJJJ      ","      JJJJJJJJJJJJJJJJJJJJJJJJJJJJJ      ","     JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ     ","     JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ     ","     JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ     ","     JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ     ","     JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ     ","     JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ     ","     JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ     ","      JJJJJJJJJJJJJJJJJJJJJJJJJJJJJ      ","      JJJJJJJJJJJJJJJJJJJJJJJJJJJJJ      ","      JJJJJJJJJJJJJJJJJJJJJJJJJJJJJ      ","       JJJJJJJJJJJJJJJJJJJJJJJJJJJ       ","       JJJJJJJJJJJJJJJJJJJJJJJJJJJ       ","        JJJJJJJJJJJJJJJJJJJJJJJJJ        ","         JJJJJJJJJJJJJJJJJJJJJJJ         ","          JJJJJJJJJJJJJJJJJJJJJ          ","           JJJJJJJJJJJJJJJJJJJ           ","            JJJJJJJJJJJJJJJJJ            ","              JJJJJJJJJJJJJ              ","                 JJJJJJJ                 ","                                         ","                                         ","                                         ","                                         ","                                         "},
        {"                                         ","                                         ","                                         ","                                         ","                                         ","                 JJJJJJJ                 ","              JJJJJJJJJJJJJ              ","            JJJJJJJJJJJJJJJJJ            ","           JJJJJJJJJJJJJJJJJJJ           ","          JJJJJJJJJJJJJJJJJJJJJ          ","         JJJJJJJJJJJJJJJJJJJJJJJ         ","        JJJJJJJJJJJJJJJJJJJJJJJJJ        ","       JJJJJJJJJJJJJJJJJJJJJJJJJJJ       ","       JJJJJJJJJJJJJJJJJJJJJJJJJJJ       ","      JJJJJJJJJJJJJJJJJJJJJJJJJJJJJ      ","      JJJJJJJJJJJJJJJJJJJJJJJJJJJJJ      ","      JJJJJJJJJJJJJJJJJJJJJJJJJJJJJ      ","     JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ     ","     JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ     ","     JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ     ","     JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ     ","     JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ     ","     JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ     ","     JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ     ","      JJJJJJJJJJJJJJJJJJJJJJJJJJJJJ      ","      JJJJJJJJJJJJJJJJJJJJJJJJJJJJJ      ","      JJJJJJJJJJJJJJJJJJJJJJJJJJJJJ      ","       JJJJJJJJJJJJJJJJJJJJJJJJJJJ       ","       JJJJJJJJJJJJJJJJJJJJJJJJJJJ       ","        JJJJJJJJJJJJJJJJJJJJJJJJJ        ","         JJJJJJJJJJJJJJJJJJJJJJJ         ","          JJJJJJJJJJJJJJJJJJJJJ          ","           JJJJJJJJJJJJJJJJJJJ           ","            JJJJJJJJJJJJJJJJJ            ","              JJJJJJJJJJJJJ              ","                 JJJJJJJ                 ","                                         ","                                         ","                                         ","                                         ","                                         "}
    };

    // spotless:on
    // endregion

    // region info
    @Override
    protected GT_Multiblock_Tooltip_Builder createTooltip() {
        final GT_Multiblock_Tooltip_Builder tt = new GT_Multiblock_Tooltip_Builder();
        tt.addMachineType(Tooltip_MiracleDoor_MachineType)
            .addInfo(Tooltip_MiracleDoor_Controller)
            .addInfo(Tooltip_MiracleDoor_00)
            .addInfo(Tooltip_MiracleDoor_01)
            .addInfo(Tooltip_MiracleDoor_02)
            .addInfo(Tooltip_MiracleDoor_03)
            .addInfo(Tooltip_MiracleDoor_04)
            .addInfo(Tooltip_MiracleDoor_05)
            .addInfo(Tooltip_MiracleDoor_06)
            .addInfo(Tooltip_MiracleDoor_07)
            .addInfo(Tooltip_MiracleDoor_08)
            .addSeparator()
            .addInfo(TextLocalization.StructureTooComplex)
            .addInfo(TextLocalization.BLUE_PRINT_INFO)
            .addStructureInfo(Tooltip_Details)
            .addStructureInfo(Tooltip_MiracleDoor_2_01)
            .addStructureInfo(Tooltip_MiracleDoor_2_02)
            .addStructureInfo(Tooltip_MiracleDoor_2_03)
            .addStructureInfo(Tooltip_MiracleDoor_2_04)
            .addStructureInfo(Tooltip_MiracleDoor_2_05)
            .addStructureInfo(Text_SeparatingLine)
            .addStructureInfo(Tooltip_DoNotNeedMaintenance)
            .addStructureInfo(Tooltip_DoNotNeedEnergyHatch)
            .toolTipFinisher(TextLocalization.ModName);
        return tt;
    }

    @Override
    public ITexture[] getTexture(IGregTechTileEntity aBaseMetaTileEntity, ForgeDirection side, ForgeDirection aFacing,
        int colorIndex, boolean aActive, boolean redstoneLevel) {
        if (side == aFacing) {
            if (aActive) {
                return new ITexture[] { casingTexturePages[0][12], TextureFactory.builder()
                    .addIcon(TexturesGtBlock.Overlay_Machine_Controller_Advanced)
                    .extFacing()
                    .build(),
                    TextureFactory.builder()
                        .addIcon(TexturesGtBlock.Overlay_Machine_Controller_Advanced_Active)
                        .extFacing()
                        .glow()
                        .build() };
            }

            return new ITexture[] { casingTexturePages[0][12], TextureFactory.builder()
                .addIcon(TexturesGtBlock.Overlay_Machine_Controller_Advanced)
                .extFacing()
                .build() };
        }

        return new ITexture[] { casingTexturePages[0][12] };
    }
}
